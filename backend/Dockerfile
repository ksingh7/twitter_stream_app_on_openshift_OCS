FROM ubuntu:18.04

RUN apt-get update -y && \
    apt-get install -y python-pip python-dev curl vim

# We copy just the requirements.txt first to leverage Docker cache
COPY ./requirements.txt /app/requirements.txt
WORKDIR /app
RUN pip install -r requirements.txt
COPY . /app
EXPOSE 8080

ENV IS_KAFKA_SSL "$IS_KAFKA_SSL"
ENV KAFKA_BOOTSTRAP_ENDPOINT "$KAFKA_BOOTSTRAP_ENDPOINT"
ENV KAFKA_TOPIC "$KAFKA_TOPIC"

ENV AYLIEN_APP_ID "$AYLIEN_APP_ID"
ENV AYLIEN_APP_KEY "$AYLIEN_APP_KEY"

ENV TWTR_CONSUMER_KEY "$TWTR_CONSUMER_KEY"
ENV TWTR_CONSUMER_SECRET "$TWTR_CONSUMER_SECRET"
ENV TWTR_ACCESS_TOKEN "$TWTR_ACCESS_TOKEN"
ENV TWTR_ACCESS_TOKEN_SECRET "$TWTR_ACCESS_TOKEN_SECRET"

ENV MONGODB_HOST "$MONGODB_HOST"
ENV MONGODB_PORT $MONGODB_PORT
ENV MONGODB_USER "$MONGODB_USER"
ENV MONGODB_PASSWORD "$MONGODB_PASSWORD"
ENV MONGODB_DB_NAME "$MONGODB_DB_NAME"


ENTRYPOINT [ "python" ]
CMD [ "app.py" ]
